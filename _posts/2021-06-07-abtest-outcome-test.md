---
layout: post
title: "ABTest数据结果检验"
date: 2021-06-07
description: "ABTest数据的检验"
tag: 数据分析
katex: true
---

ABTest 最后一步就是要对收集到的数据去分析结果，主要有三点需要注意：

1. 一定要等到到达足够样本量是在分析测试结果
2. 分析结果前一定要做合理性检验来确保测试质量，否则实施过程如果出现Bug，就会功亏一篑
3. 一定要根据指标和数据的特点，选择正确的分析方法来得出可以驱动业务的结论

## 达到足够样本量后在分析测试结果

假设实验进行到某一天，不过样本量没有达到预期，我们发现实验组和对照组的观察指标出现了显著的不同，**这并不意味着实验提前成功了**！！主要有两方面原因：

On the one hand，因为样本量是不断变化的，所以每次观测到的测试其实都可以算作新的实验。根据统计上的惯例，A/B 测试一般有 5% 的第一类错误率α，也就是说每重复测试 100 次，平均就会得到 5 次错误的统计显著性的结果。这就意味着如果我们观测的次数变多的话，那么观测到错误的统计显著结果的概率就会提升，这是多重检验问题。

On the other hand，提前观测到统计显著的结果，这就意味着样本量并未达到事先估算的最小样本量，那么这个所谓的"统计显著的结果"就极有可能是错误的假阳性（第一类错误）。

## 分析前做合理性检验保证实验质量

当样本量满足最小样本量制后，还需对实验进行合理性检验。由[这儿](https://pangzhengyang.github.io/2021/04/abtest-process/) 可知合理性检验分为**业务品质和统计品质**。

统计品质主要分为两个部分：样本量、样本特征。

### 检验实验组 / 对照组样本量的比例

各组样本量占总样本量的比列也是概率，所以也符合二项分布，具体的操作方法：

- 首先，根据二项分布的公式$\sqrt {\frac{p(1-p)} {n} }$ 算出标准误差
- 然后，以0.5（50%）为中心构建95%的置信区间
- 最后，确认实际的两组样本量的比例是否在置信区间内

如果总的比例在置信区间内的话，就说明即使总的比例不完全等于 50%/50%，也是非常接近，属于正常波动，两组样本量大小就符合预期。否则，就说明实验有问题。

### 检验实验组 / 对照组特征分布

常用的特征包括：性别、年龄、地点等信息，或者可能影响观察指标的特征。

如果合理性检验未通过，则需要找到出现问题的原因，解决原因再做AB Test。找原因 又是一个很工程的问题了：主要和研发、工程师一起从流程方向找咯~

## 分析AB Test的结果

主要是对比实验组和测试组的观察指标是否有显著不同。“显著”就是要排除随机偶然因素，通过统计的方法来证明两者的不同是事实存在的，而不是由于波动性造成的巧合。

使用假设检验中的p值法或者置信区间。

相关检验主要是：t-test和z-test。


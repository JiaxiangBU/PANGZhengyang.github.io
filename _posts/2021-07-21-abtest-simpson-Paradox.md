---
layout: post
title: "ABTest常见误区——辛普森悖论"
date: 2021-07-21
description: "ABTest辛普森悖论"
tag: 数据分析
katex: true
---

辛普森悖论在AB Test中经常发生，特别是我们在进行细分分析的时候。所以每次在做细分分析时，需要先检查细分领域在两组的比例是否符合两组整体的比例，来确保实验结果准确。

下面以马卡龙App实际例子来看看这个问题，数据已脱敏~

马卡龙App优化了新用户的注册流程，并且希望通过 A/B 测试在北京、上海这两个主要的市场来验证优化注册后的转化率是否有所提升。

- 实验组：使用优化后的注册流程。
- 对照组：使用原有的注册流程。

在设计好了实验之后，实验组和对照组的样本量均分。等跑完实验，获得了足够的实验样本之后，结果得到实验组的转化率为 **1.44%**， 对照组的转化率为 **2.02%**。

这就很让人意外了，为什么实验组（使用优化后的注册流程）的转化率，反而比对照组（使用原有的注册流程）的转化率要低呢？而且更让人意外的是，当你在分别分析北京和上海这两个市场时，会发现它们的实验组转化率都比对照组的要高。如下图：

![2021-07-21-simpson-paradox.png](/assets/2021-07-21-abtest-simpson-paradox.png)

同样的数据，在进行总体分析和细分分析是产生截然相反的结论，这个就是辛普森悖论。

对于上述例子，虽然我们的实验组和对照组的流量实现了均分，但是在北京和上海这两个细分市场中却分布不均，没有实现样本量均分。

> 在A/B Test中，我们通常根据市场（国家，城市等）、设备类型（手机、桌面、平板等），用户互动或者花费程度（轻度、中毒、重度）来进行细分分析。

## 如何解决避免辛普森悖论

我们知道了发生辛普森悖论的原因主要就是 **实验中两组在不同细分领域中的分布不均**，那我们避免这个问题，可以检查每组不同细分领域的样本量是否均匀。

如果发生了辛普森悖论，那么可以检查每组的细分领域样本量，然后检查是否是工程上出现的问题；如果没有时间重跑实验，**那么以细分领域出的结果为准。**
